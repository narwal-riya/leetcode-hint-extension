(function() {
  function addElements() {
    // Prevent duplicate button
    if (document.getElementById("leet-hint-btn")) return;

    // Check if we are inside a problem page (LeetCode marks problems with "question-title")
    const problemTitle = document.querySelector('[data-cy="question-title"]');
    if (!problemTitle) return; // not a problem page, exit

    // Create button
    const button = document.createElement("button");
    button.id = "leet-hint-btn";
    button.innerText = "ðŸ’¡ Show Hint";
    button.style.position = "fixed";
    button.style.bottom = "20px";
    button.style.right = "20px";
    button.style.zIndex = "9999";

    // Create hint container
    const container = document.createElement("div");
    container.id = "leet-hint-container";
    container.innerHTML = `
      <div class="hint-content">
        <h3>Hint</h3>
        <p>Think about the core data structure or pattern here.</p>
        <button id="close-hint">Close</button>
      </div>
    `;
    document.body.appendChild(container);
    document.body.appendChild(button);

    // Show/Hide logic
    button.addEventListener("click", () => {
      container.style.display = container.style.display === "none" ? "block" : "none";
    });

    container.querySelector("#close-hint").addEventListener("click", () => {
      container.style.display = "none";
    });
  }

  // Wait for page load
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", addElements);
  } else {
    addElements();
  }

  // Handle dynamic navigation on LeetCode (SPA)
  const observer = new MutationObserver(() => addElements());
  observer.observe(document.body, { childList: true, subtree: true });
})();
